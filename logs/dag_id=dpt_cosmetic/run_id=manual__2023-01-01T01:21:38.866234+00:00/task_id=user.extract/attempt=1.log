[2023-01-01T01:21:53.824+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: dpt_cosmetic.user.extract manual__2023-01-01T01:21:38.866234+00:00 [queued]>
[2023-01-01T01:21:53.876+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: dpt_cosmetic.user.extract manual__2023-01-01T01:21:38.866234+00:00 [queued]>
[2023-01-01T01:21:53.877+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2023-01-01T01:21:53.879+0000] {taskinstance.py:1363} INFO - Starting attempt 1 of 1
[2023-01-01T01:21:53.881+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2023-01-01T01:21:53.967+0000] {taskinstance.py:1383} INFO - Executing <Task(ExtractOperator): user.extract> on 2023-01-01 01:21:38.866234+00:00
[2023-01-01T01:21:53.984+0000] {standard_task_runner.py:55} INFO - Started process 933 to run task
[2023-01-01T01:21:54.000+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'dpt_cosmetic', 'user.extract', 'manual__2023-01-01T01:21:38.866234+00:00', '--job-id', '137', '--raw', '--subdir', 'DAGS_FOLDER/main.py', '--cfg-path', '/tmp/tmpwxuq0_i5']
[2023-01-01T01:21:54.003+0000] {standard_task_runner.py:83} INFO - Job 137: Subtask user.extract
[2023-01-01T01:21:54.310+0000] {task_command.py:376} INFO - Running <TaskInstance: dpt_cosmetic.user.extract manual__2023-01-01T01:21:38.866234+00:00 [running]> on host 6bd76effbc07
[2023-01-01T01:21:54.631+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=dpt_cosmetic
AIRFLOW_CTX_TASK_ID=user.extract
AIRFLOW_CTX_EXECUTION_DATE=2023-01-01T01:21:38.866234+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-01-01T01:21:38.866234+00:00
[2023-01-01T01:21:54.673+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "pandas/_libs/tslibs/offsets.pyx", line 661, in pandas._libs.tslibs.offsets.BaseOffset._validate_n
TypeError: int() argument must be a string, a bytes-like object or a number, not 'Cursor'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/airflow/dags/utilties/extract_operator.py", line 22, in execute
    df=pd.DateOffset(data)
  File "pandas/_libs/tslibs/offsets.pyx", line 1000, in pandas._libs.tslibs.offsets.RelativeDeltaOffset.__init__
  File "pandas/_libs/tslibs/offsets.pyx", line 361, in pandas._libs.tslibs.offsets.BaseOffset.__init__
  File "pandas/_libs/tslibs/offsets.pyx", line 663, in pandas._libs.tslibs.offsets.BaseOffset._validate_n
TypeError: `n` argument must be an integer, got <class 'pymongo.cursor.Cursor'>
[2023-01-01T01:21:54.718+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=dpt_cosmetic, task_id=user.extract, execution_date=20230101T012138, start_date=20230101T012153, end_date=20230101T012154
[2023-01-01T01:21:54.768+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 137 for task user.extract (`n` argument must be an integer, got <class 'pymongo.cursor.Cursor'>; 933)
[2023-01-01T01:21:54.812+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2023-01-01T01:21:54.918+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
